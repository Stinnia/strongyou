<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Untitled Document</title>
<script src="https://www.gstatic.com/firebasejs/5.5.6/firebase.js"></script>
<script>
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyBXbrqGD01x4wou1JjgBS7nKDHVIbt6ihY",
    authDomain: "workout-4d072.firebaseapp.com",
    databaseURL: "https://workout-4d072.firebaseio.com",
    projectId: "workout-4d072",
    storageBucket: "workout-4d072.appspot.com",
    messagingSenderId: "431224881060"
  };
  firebase.initializeApp(config);
</script>
</head>

<body>
<h2>All players and scores</h2>
<pre id="output"></pre>
<hr>
<h2>Create new player</h2>
<form>
  <p>
    <input type="text" name="name" id="name" placeholder="Playername" required>
  </p>
  <p>
    <input type="number" name="score" id="score" placeholder="Score" required>
  </p>
  <button type="submit" id="submit">Create new player</button>
</form>
<script>
	
	  var database = firebase.database();
	var submitButton = document.getElementById('submit');
	submitButton.addEventListener('click', createPlayer);
											   
	// read from database
	database.ref('workout/').once('value', function(snapshot) {
   		snapshot.forEach(function (childSnap) {
			// storing all keys (i.e. "player1", "player2", ... )
			let kiloGrams = childSnap.child('kg').val();
			// storing all values of the child node "score"
			let repetition = childSnap.child('rep').val();
  			console.log(kiloGrams);
			// rendering the keys and values
			document.getElementById('output').innerHTML += kiloGrams + ' kg' + ': ' + repetition + ' reps' + '<br>';
 		});
  });
	
// write to database
	function createPlayer () {
		var kg = document.getElementById('kg').value;
		var rep = document.getElementById('rep').value;
		// console.log(name + ', ' + score)
		// storing user input in an object
		var playerData = {
			"kg" : kg,
			"rep" : rep
		}
		// generate a firebase key for the object
		var newPlayer = database.ref('workout/').push().key;
		// update database with the player object
		database.ref('workout/' + newPlayer).update(playerData);
	}
</script>
</body>
</html>
